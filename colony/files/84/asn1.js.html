<h1>asn1.js</h1>
<pre><code class="lang-js"><span class="comment">// from https://github.com/indutny/self-signed/blob/gh-pages/lib/asn1.js</span>
<span class="comment">// Fedor, you are amazing.</span>
<span class="string">'use strict'</span>

<span class="keyword">var</span> asn1 = require(<span class="string">'asn1.js'</span>)

exports.certificate = require(<span class="string">'./certificate'</span>)

<span class="keyword">var</span> RSAPrivateKey = asn1.define(<span class="string">'RSAPrivateKey'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'version'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'modulus'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'publicExponent'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'privateExponent'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'prime1'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'prime2'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'exponent1'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'exponent2'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'coefficient'</span>).int()
  )
})
exports.RSAPrivateKey = RSAPrivateKey

<span class="keyword">var</span> RSAPublicKey = asn1.define(<span class="string">'RSAPublicKey'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'modulus'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'publicExponent'</span>).int()
  )
})
exports.RSAPublicKey = RSAPublicKey

<span class="keyword">var</span> PublicKey = asn1.define(<span class="string">'SubjectPublicKeyInfo'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'algorithm'</span>).use(AlgorithmIdentifier),
    <span class="keyword">this</span>.key(<span class="string">'subjectPublicKey'</span>).bitstr()
  )
})
exports.PublicKey = PublicKey

<span class="keyword">var</span> AlgorithmIdentifier = asn1.define(<span class="string">'AlgorithmIdentifier'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'algorithm'</span>).objid(),
    <span class="keyword">this</span>.key(<span class="string">'none'</span>).null_().optional(),
    <span class="keyword">this</span>.key(<span class="string">'curve'</span>).objid().optional(),
    <span class="keyword">this</span>.key(<span class="string">'params'</span>).seq().obj(
      <span class="keyword">this</span>.key(<span class="string">'p'</span>).int(),
      <span class="keyword">this</span>.key(<span class="string">'q'</span>).int(),
      <span class="keyword">this</span>.key(<span class="string">'g'</span>).int()
    ).optional()
  )
})

<span class="keyword">var</span> PrivateKeyInfo = asn1.define(<span class="string">'PrivateKeyInfo'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'version'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'algorithm'</span>).use(AlgorithmIdentifier),
    <span class="keyword">this</span>.key(<span class="string">'subjectPrivateKey'</span>).octstr()
  )
})
exports.PrivateKey = PrivateKeyInfo
<span class="keyword">var</span> EncryptedPrivateKeyInfo = asn1.define(<span class="string">'EncryptedPrivateKeyInfo'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'algorithm'</span>).seq().obj(
      <span class="keyword">this</span>.key(<span class="string">'id'</span>).objid(),
      <span class="keyword">this</span>.key(<span class="string">'decrypt'</span>).seq().obj(
        <span class="keyword">this</span>.key(<span class="string">'kde'</span>).seq().obj(
          <span class="keyword">this</span>.key(<span class="string">'id'</span>).objid(),
          <span class="keyword">this</span>.key(<span class="string">'kdeparams'</span>).seq().obj(
            <span class="keyword">this</span>.key(<span class="string">'salt'</span>).octstr(),
            <span class="keyword">this</span>.key(<span class="string">'iters'</span>).int()
          )
        ),
        <span class="keyword">this</span>.key(<span class="string">'cipher'</span>).seq().obj(
          <span class="keyword">this</span>.key(<span class="string">'algo'</span>).objid(),
          <span class="keyword">this</span>.key(<span class="string">'iv'</span>).octstr()
        )
      )
    ),
    <span class="keyword">this</span>.key(<span class="string">'subjectPrivateKey'</span>).octstr()
  )
})

exports.EncryptedPrivateKey = EncryptedPrivateKeyInfo

<span class="keyword">var</span> DSAPrivateKey = asn1.define(<span class="string">'DSAPrivateKey'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'version'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'p'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'q'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'g'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'pub_key'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'priv_key'</span>).int()
  )
})
exports.DSAPrivateKey = DSAPrivateKey

exports.DSAparam = asn1.define(<span class="string">'DSAparam'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.int()
})

<span class="keyword">var</span> ECPrivateKey = asn1.define(<span class="string">'ECPrivateKey'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'version'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'privateKey'</span>).octstr(),
    <span class="keyword">this</span>.key(<span class="string">'parameters'</span>).optional().explicit(<span class="number">0</span>).use(ECParameters),
    <span class="keyword">this</span>.key(<span class="string">'publicKey'</span>).optional().explicit(<span class="number">1</span>).bitstr()
  )
})
exports.ECPrivateKey = ECPrivateKey

<span class="keyword">var</span> ECParameters = asn1.define(<span class="string">'ECParameters'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.choice({
    namedCurve: <span class="keyword">this</span>.objid()
  })
})

exports.signature = asn1.define(<span class="string">'signature'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.seq().obj(
    <span class="keyword">this</span>.key(<span class="string">'r'</span>).int(),
    <span class="keyword">this</span>.key(<span class="string">'s'</span>).int()
  )
})
</code></pre>