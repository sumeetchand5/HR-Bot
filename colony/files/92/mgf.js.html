<h1>mgf.js</h1>
<pre><code class="lang-js"><span class="keyword">var</span> createHash = require(<span class="string">'create-hash'</span>)
<span class="keyword">var</span> Buffer = require(<span class="string">'safe-buffer'</span>).Buffer

module.exports = <span class="function"><span class="keyword">function</span> <span class="params">(seed, len)</span> {</span>
  <span class="keyword">var</span> t = Buffer.alloc(<span class="number">0</span>)
  <span class="keyword">var</span> i = <span class="number">0</span>
  <span class="keyword">var</span> c
  <span class="keyword">while</span> (t.length &lt; len) {
    c = i2ops(i++)
    t = Buffer.concat([t, createHash(<span class="string">'sha1'</span>).update(seed).update(c).digest()])
  }
  <span class="keyword">return</span> t.slice(<span class="number">0</span>, len)
}

<span class="function"><span class="keyword">function</span> <span class="title">i2ops</span> <span class="params">(c)</span> {</span>
  <span class="keyword">var</span> out = Buffer.allocUnsafe(<span class="number">4</span>)
  out.writeUInt32BE(c, <span class="number">0</span>)
  <span class="keyword">return</span> out
}
</code></pre>