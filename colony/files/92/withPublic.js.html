<h1>withPublic.js</h1>
<pre><code class="lang-js"><span class="keyword">var</span> BN = require(<span class="string">'bn.js'</span>)
<span class="keyword">var</span> Buffer = require(<span class="string">'safe-buffer'</span>).Buffer

<span class="function"><span class="keyword">function</span> <span class="title">withPublic</span> <span class="params">(paddedMsg, key)</span> {</span>
  <span class="keyword">return</span> Buffer.from(paddedMsg
    .toRed(BN.mont(key.modulus))
    .redPow(<span class="keyword">new</span> BN(key.publicExponent))
    .fromRed()
    .toArray())
}

module.exports = withPublic
</code></pre>