<h1>index.js</h1>
<pre><code class="lang-js"><span class="keyword">var</span> assert = require(<span class="string">'assert'</span>)

<span class="comment">/**
 * Get a list of all identifiers that are initialised by this (possibly destructuring)
 * node.
 *
 * eg with input:
 *
 * var { a: [b, ...c], d } = xyz
 *
 * this returns the nodes for 'b', 'c', and 'd'
 */</span>
module.exports = <span class="function"><span class="keyword">function</span> <span class="title">getAssignedIdentifiers</span> <span class="params">(node, identifiers)</span> {</span>
  assert.equal(<span class="keyword">typeof</span> node, <span class="string">'object'</span>, <span class="string">'get-assigned-identifiers: node must be object'</span>)
  assert.equal(<span class="keyword">typeof</span> node.type, <span class="string">'string'</span>, <span class="string">'get-assigned-identifiers: node must have a type'</span>)

  identifiers = identifiers || []

  <span class="keyword">if</span> (node.type === <span class="string">'ImportDeclaration'</span>) {
    node.specifiers.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(el)</span> {</span>
      getAssignedIdentifiers(el, identifiers)
    })
  }

  <span class="keyword">if</span> (node.type === <span class="string">'ImportDefaultSpecifier'</span> || node.type === <span class="string">'ImportNamespaceSpecifier'</span> || node.type === <span class="string">'ImportSpecifier'</span>) {
    node = node.local
  }

  <span class="keyword">if</span> (node.type === <span class="string">'RestElement'</span>) {
    node = node.argument
  }

  <span class="keyword">if</span> (node.type === <span class="string">'ArrayPattern'</span>) {
    node.elements.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(el)</span> {</span>
      <span class="comment">// `el` might be `null` in case of `[x,,y] = whatever`</span>
      <span class="keyword">if</span> (el) {
        getAssignedIdentifiers(el, identifiers)
      }
    })
  }

  <span class="keyword">if</span> (node.type === <span class="string">'ObjectPattern'</span>) {
    node.properties.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(prop)</span> {</span>
      <span class="keyword">if</span> (prop.type === <span class="string">'Property'</span>) {
        getAssignedIdentifiers(prop.value, identifiers)
      } <span class="keyword">else</span> <span class="keyword">if</span> (prop.type === <span class="string">'RestElement'</span>) {
        getAssignedIdentifiers(prop, identifiers)
      }
    })
  }

  <span class="keyword">if</span> (node.type === <span class="string">'Identifier'</span>) {
    identifiers.push(node)
  }

  <span class="keyword">return</span> identifiers
}
</code></pre>