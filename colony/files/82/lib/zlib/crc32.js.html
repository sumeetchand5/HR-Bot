<h1>crc32.js</h1>
<pre><code class="lang-js"><span class="string">'use strict'</span>;

<span class="comment">// Note: we can't get significant speed boost here.</span>
<span class="comment">// So write code to minimize size - no pregenerated tables</span>
<span class="comment">// and array tools dependencies.</span>

<span class="comment">// (C) 1995-2013 Jean-loup Gailly and Mark Adler</span>
<span class="comment">// (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin</span>
<span class="comment">//</span>
<span class="comment">// This software is provided 'as-is', without any express or implied</span>
<span class="comment">// warranty. In no event will the authors be held liable for any damages</span>
<span class="comment">// arising from the use of this software.</span>
<span class="comment">//</span>
<span class="comment">// Permission is granted to anyone to use this software for any purpose,</span>
<span class="comment">// including commercial applications, and to alter it and redistribute it</span>
<span class="comment">// freely, subject to the following restrictions:</span>
<span class="comment">//</span>
<span class="comment">// 1. The origin of this software must not be misrepresented; you must not</span>
<span class="comment">//   claim that you wrote the original software. If you use this software</span>
<span class="comment">//   in a product, an acknowledgment in the product documentation would be</span>
<span class="comment">//   appreciated but is not required.</span>
<span class="comment">// 2. Altered source versions must be plainly marked as such, and must not be</span>
<span class="comment">//   misrepresented as being the original software.</span>
<span class="comment">// 3. This notice may not be removed or altered from any source distribution.</span>

<span class="comment">// Use ordinary array, since untyped makes no boost here</span>
<span class="function"><span class="keyword">function</span> <span class="title">makeTable</span><span class="params">()</span> {</span>
  <span class="keyword">var</span> c, table = [];

  <span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; <span class="number">256</span>; n++) {
    c = n;
    <span class="keyword">for</span> (<span class="keyword">var</span> k = <span class="number">0</span>; k &lt; <span class="number">8</span>; k++) {
      c = ((c &amp; <span class="number">1</span>) ? (<span class="number">0xEDB88320</span> ^ (c >>> <span class="number">1</span>)) : (c >>> <span class="number">1</span>));
    }
    table[n] = c;
  }

  <span class="keyword">return</span> table;
}

<span class="comment">// Create table on load. Just 255 signed longs. Not a problem.</span>
<span class="keyword">var</span> crcTable = makeTable();


<span class="function"><span class="keyword">function</span> <span class="title">crc32</span><span class="params">(crc, buf, len, pos)</span> {</span>
  <span class="keyword">var</span> t = crcTable,
      end = pos + len;

  crc ^= -<span class="number">1</span>;

  <span class="keyword">for</span> (<span class="keyword">var</span> i = pos; i &lt; end; i++) {
    crc = (crc >>> <span class="number">8</span>) ^ t[(crc ^ buf[i]) &amp; <span class="number">0xFF</span>];
  }

  <span class="keyword">return</span> (crc ^ (-<span class="number">1</span>)); <span class="comment">// >>> 0;</span>
}


module.exports = crc32;
</code></pre>