<h1>index.js</h1>
<pre><code class="lang-js"><span class="keyword">var</span> CipherBase = require(<span class="string">'cipher-base'</span>)
<span class="keyword">var</span> des = require(<span class="string">'des.js'</span>)
<span class="keyword">var</span> inherits = require(<span class="string">'inherits'</span>)
<span class="keyword">var</span> Buffer = require(<span class="string">'safe-buffer'</span>).Buffer

<span class="keyword">var</span> modes = {
  <span class="string">'des-ede3-cbc'</span>: des.CBC.instantiate(des.EDE),
  <span class="string">'des-ede3'</span>: des.EDE,
  <span class="string">'des-ede-cbc'</span>: des.CBC.instantiate(des.EDE),
  <span class="string">'des-ede'</span>: des.EDE,
  <span class="string">'des-cbc'</span>: des.CBC.instantiate(des.DES),
  <span class="string">'des-ecb'</span>: des.DES
}
modes.des = modes[<span class="string">'des-cbc'</span>]
modes.des3 = modes[<span class="string">'des-ede3-cbc'</span>]
module.exports = DES
inherits(DES, CipherBase)
<span class="function"><span class="keyword">function</span> <span class="title">DES</span> <span class="params">(opts)</span> {</span>
  CipherBase.call(<span class="keyword">this</span>)
  <span class="keyword">var</span> modeName = opts.mode.toLowerCase()
  <span class="keyword">var</span> mode = modes[modeName]
  <span class="keyword">var</span> type
  <span class="keyword">if</span> (opts.decrypt) {
    type = <span class="string">'decrypt'</span>
  } <span class="keyword">else</span> {
    type = <span class="string">'encrypt'</span>
  }
  <span class="keyword">var</span> key = opts.key
  <span class="keyword">if</span> (!Buffer.isBuffer(key)) {
    key = Buffer.from(key)
  }
  <span class="keyword">if</span> (modeName === <span class="string">'des-ede'</span> || modeName === <span class="string">'des-ede-cbc'</span>) {
    key = Buffer.concat([key, key.slice(<span class="number">0</span>, <span class="number">8</span>)])
  }
  <span class="keyword">var</span> iv = opts.iv
  <span class="keyword">if</span> (!Buffer.isBuffer(iv)) {
    iv = Buffer.from(iv)
  }
  <span class="keyword">this</span>._des = mode.create({
    key: key,
    iv: iv,
    type: type
  })
}
DES.prototype._update = <span class="function"><span class="keyword">function</span> <span class="params">(data)</span> {</span>
  <span class="keyword">return</span> Buffer.from(<span class="keyword">this</span>._des.update(data))
}
DES.prototype._final = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  <span class="keyword">return</span> Buffer.from(<span class="keyword">this</span>._des.final())
}
</code></pre>